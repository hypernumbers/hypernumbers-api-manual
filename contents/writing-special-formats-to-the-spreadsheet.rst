===============
Special Formats
===============

There are a number of special formatting options:

* plain and rich text inline editable cells and dropdown boxes
* ghosted cells
* cell merging

Inline Editing
--------------

A spreadsheet cell can be 'turned on' to work in a wiki page with the following API calls:

.. tabularcolumns:: |l|L|

=========== ===============================================================================
Component   Details
=========== ===============================================================================
Method      ``POST``

Headers     ``{"Accept", "application/json"}``

            ``{"Content-MD5", MD5 hash sum of body}``

            ``{"Authorization", generated by api client library}``

Body        ``{"set":{"input": "inline"}}``

            ``{"set":{"input": "inlinerich"}}``

            ``{"set": {"input": {"select": ["abc", "1", "-1.0", "true", "#REF!"]}}}``

            ``{"set": {"input": {"dynamic_select": ["/some/page/a1:a3"]}}}``

            ``{"set": {"input": {"dynamic_select": ["/some/[b7 > 0]/a1:a3"]}}}``

            ``{"set":{"input": "none"}}``

            ``{"clear": "style"}``

            ``{"clear": "all"}``

Permissions ``normal`` or ``admin``

Cell        ``http://example.com/some/page/b7``

Range       ``http://example.com/some/page/b7:b9``
=========== ===============================================================================

Unlike in a spreadsheet cell if these inputs begin with an equals sign they are sharp-quoted and can't be used to input formula.

``inline`` creates an input box like a normal spreaedsheet cell in the wiki page.

``inlinerich`` cells load a full rich text editor (and enable the user to enter a sub-set of html - but no formulae). To get best use of the rich text editor the size of the inline should be increased with a ``merge`` api call. The GUI merges the cell 6 cells to the right and 10 cells down.

``input`` with ``select`` creates a dropdown box from a fixed list of spreadsheet values expressed as strings. These values are the only accepted inputs on the wiki page - the spreadsheet page continues to accept any valid input.


``input`` with ``dynamic_select`` picks up its options from cells on the spreadsheet. If they change the available option set updates itself. The cells to be used are referenced by a URL. This URL be a simple one, or a `z-query`_.

.. _z-query: http://documentation.vixo.com/contents/indepth/database-queries.html?from=vixo-api-manual

Setting the input to none removes the various inline editing capabilities. You can also clear an inline special format with ``clear``. The ``style`` option will remove the special format (and any ghost, merge and cell formats) but leave the numerical format and the value of the cell unchanged. The ``all`` option will remove both contents and cell and special formats.

Ghosted Cells
-------------

Sometimes you wish to have some calculation logic on a spreadsheet page which you would prefer not to have on the web or wiki page that is being shown to users.

The ``ghost`` special format is for this circumstance. It uses the following API:

.. tabularcolumns:: |l|L|

=========== ============================================
Component   Details
=========== ============================================
Method      ``POST``

Headers     ``{"Accept", "application/json"}``

            ``{"Content-MD5", MD5 hash sum of body}``

            ``{"Authorization", generated by api client library}``

Body        ``{"ghost": "true"}``

            ``{"ghost": "false"}``

            ``{"clear": "style"}``

            ``{"clear": "all"}``

Permissions ``normal`` or ``admin``

Cell        ``http://example.com/some/page/b7``

Range       ``http://example.com/some/page/b7:b9``
=========== ============================================

The two ``clear`` options work as previously described in this section.

Merge Cells
-----------

Cells can be merged whereby once cell is made bigger and it covers (and hides) a set of other cells. The merge API is:

.. tabularcolumns:: |l|L|

=========== ============================================
Component   Details
=========== ============================================
Method      ``POST``

Headers     ``{"Accept", "application/json"}``

            ``{"Content-MD5", MD5 hash sum of body}``

            ``{"Authorization", generated by api client library}``

Body        ``{"merge": {"right": 4, "down", 5}}``

            ``{"clear": "merge"}``

            ``{"clear": "style"}``

            ``{"clear": "all"}``

Permissions ``normal`` or ``admin``

Cell        ``http://example.com/some/page/b7``

Range       ``http://example.com/some/page/b7:b9``
=========== ============================================

.. Note::

    The figures to merge the cell by are integers (and not string representation of integers).

    Clearing works as previously described in this section.

